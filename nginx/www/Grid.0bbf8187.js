import{B as se,n as I,s as N,S as B,i as F,e as E,a as M,c as w,b as y,f as p,g as q,h as u,C as V,j as C,k,l as j,D as ne,E as le,F as $,G as S,r as ie,o as oe,q as J,u as W,v as Q,H as ce,x as ae,y as U,w as A,z as Y,I as re,J as ue,K as he,A as de,L as fe}from"./chunks/index.2f5274eb.js";/* empty css                                                  */function me(t){const e=t-1;return e*e*e+1}function _e(t,{from:e,to:s},n={}){const i=getComputedStyle(t),o=i.transform==="none"?"":i.transform,[l,r]=i.transformOrigin.split(" ").map(parseFloat),c=e.left+e.width*l/s.width-(s.left+l),a=e.top+e.height*r/s.height-(s.top+r),{delay:d=0,duration:h=f=>Math.sqrt(f)*120,easing:m=me}=n;return{delay:d,duration:se(h)?h(Math.sqrt(c*c+a*a)):h,easing:m,css:(f,v)=>{const g=v*c,_=v*a,b=f+v*e.width/s.width,T=f+v*e.height/s.height;return`transform: ${o} translate(${g}px, ${_}px) scale(${b}, ${T});`}}}const D=[];function ge(t,e=I){let s;const n=new Set;function i(r){if(N(t,r)&&(t=r,s)){const c=!D.length;for(const a of n)a[1](),D.push(a,t);if(c){for(let a=0;a<D.length;a+=2)D[a][0](D[a+1]);D.length=0}}}function o(r){i(r(t))}function l(r,c=I){const a=[r,c];return n.add(a),n.size===1&&(s=e(i)||I),r(t),()=>{n.delete(a),n.size===0&&(s(),s=null)}}return{set:i,update:o,subscribe:l}}const X=(t,e,s=24,n=1)=>fetch(`/api/knn?museum=${t}&id=${e}&k=${s}&z=${n}`).then(i=>i.json()),pe=()=>fetch("/api/random").then(t=>t.json()).then(t=>t.hits[0]),ve=t=>fetch(`/api/search?q=${t}`).then(e=>e.json()).then(e=>e.hits),P=t=>[t[23],t[21],t[19],t[17],t[15],t[13],t[11],t[9],t[7],t[5],t[3],t[1],t[0],t[2],t[4],t[6],t[8],t[10],t[12],t[14],t[16],t[18],t[20],t[22],t[24]].filter(e=>e),be=()=>{const{subscribe:t,set:e}=ge([]),s=(o,l=1)=>X(o.museum,o.id,24,l).then(r=>{e(P([o,...r]))}),n=()=>pe().then(o=>X(o.museum,o.id).then(l=>{e(P([o,...l]))})),i=o=>ve(o).then(l=>e(P(l)));return window.location.hash?i(window.location.hash.substring(1)):n(),{randomize:n,search:i,setCenter:s,subscribe:t}},L=be();function ye(t){let e,s,n,i,o;return{c(){e=E("div"),n=M(),i=E("img"),this.h()},l(l){e=w(l,"DIV",{class:!0,style:!0}),y(e).forEach(p),n=q(l),i=w(l,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),this.h()},h(){u(e,"class","shading svelte-1d4e5a5"),u(e,"style",s=`background-color: ${t[1]}`),ne(i.src,o=t[4](t[3]))||u(i,"src",o),u(i,"width","120"),u(i,"height","120"),u(i,"alt","Flippable back"),u(i,"class","svelte-1d4e5a5")},m(l,r){C(l,e,r),C(l,n,r),C(l,i,r)},p(l,r){r&2&&s!==(s=`background-color: ${l[1]}`)&&u(e,"style",s)},d(l){l&&p(e),l&&p(n),l&&p(i)}}}function ke(t){let e,s,n,i,o,l,r,c,a=t[3]&&ye(t);return{c(){e=E("div"),s=E("div"),n=E("div"),i=M(),o=E("div"),a&&a.c(),this.h()},l(d){e=w(d,"DIV",{class:!0});var h=y(e);s=w(h,"DIV",{class:!0,"data-delay":!0});var m=y(s);n=w(m,"DIV",{class:!0});var f=y(n);f.forEach(p),i=q(m),o=w(m,"DIV",{class:!0});var v=y(o);a&&a.l(v),v.forEach(p),m.forEach(p),h.forEach(p),this.h()},h(){u(n,"class","front svelte-1d4e5a5"),u(o,"class","back svelte-1d4e5a5"),u(s,"class","card svelte-1d4e5a5"),u(s,"data-delay",l=`${t[0]}ms`),u(e,"class","card-container svelte-1d4e5a5"),V(e,"flipped",t[2]===t[3]),V(e,"flipping",t[2]!==t[3])},m(d,h){C(d,e,h),k(e,s),k(s,n),k(s,i),k(s,o),a&&a.m(o,null),r||(c=j(e,"click",t[7]),r=!0)},p(d,[h]){d[3]&&a.p(d,h),h&1&&l!==(l=`${d[0]}ms`)&&u(s,"data-delay",l),h&12&&V(e,"flipped",d[2]===d[3]),h&12&&V(e,"flipping",d[2]!==d[3])},i:I,o:I,d(d){d&&p(e),a&&a.d(),r=!1,c()}}}const Ee=600;function we(t,e,s){let{src:n}=e,{museum:i}=e,{delay:o}=e,l,r,c=n;const a=h=>h.includes("sammlung.wienmuseum.at")?`/api/proxy?url=${h}`:h;function d(h){le.call(this,t,h)}return t.$$set=h=>{"src"in h&&s(5,n=h.src),"museum"in h&&s(6,i=h.museum),"delay"in h&&s(0,o=h.delay)},t.$$.update=()=>{t.$$.dirty&33&&setTimeout(()=>{s(2,r=n)},Ee+o),t.$$.dirty&64&&(i=="WM"?s(1,l="red"):i==="BEL"?s(1,l="green"):i==="MAK"&&s(1,l="blue"))},[o,l,r,c,a,n,i,d]}class Ie extends B{constructor(e){super(),F(this,e,we,ke,N,{src:5,museum:6,delay:0})}}function Ce(t){let e,s,n,i,o,l,r,c;return{c(){e=E("div"),s=$("svg"),n=$("line"),i=$("g"),o=$("circle"),l=$("circle"),this.h()},l(a){e=w(a,"DIV",{class:!0});var d=y(e);s=S(d,"svg",{width:!0,height:!0,class:!0});var h=y(s);n=S(h,"line",{x1:!0,y1:!0,x2:!0,y2:!0,class:!0}),y(n).forEach(p),i=S(h,"g",{class:!0});var m=y(i);o=S(m,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(o).forEach(p),l=S(m,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(l).forEach(p),m.forEach(p),h.forEach(p),d.forEach(p),this.h()},h(){u(n,"x1","0"),u(n,"y1","20"),u(n,"x2",z),u(n,"y2",R/2),u(n,"class","svelte-12l1n2j"),u(o,"class","dot svelte-12l1n2j"),u(o,"cx",t[0]),u(o,"cy",R/2),u(o,"r",t[1]),u(l,"class","border svelte-12l1n2j"),u(l,"cx",t[0]),u(l,"cy",R/2),u(l,"r",ee),u(i,"class","handle svelte-12l1n2j"),u(s,"width",z),u(s,"height",R),u(s,"class","svelte-12l1n2j"),u(e,"class","neighbourhood svelte-12l1n2j")},m(a,d){C(a,e,d),k(e,s),k(s,n),k(s,i),k(i,o),k(i,l),r||(c=[j(l,"pointerdown",t[2]),j(l,"pointermove",t[3]),j(l,"pointerup",t[4])],r=!0)},p(a,[d]){d&1&&u(o,"cx",a[0]),d&2&&u(o,"r",a[1]),d&1&&u(l,"cx",a[0])},i:I,o:I,d(a){a&&p(e),r=!1,ie(c)}}}const z=200,R=40,Z=3,ee=14;function De(t,e,s){let n;const i=oe();let o=!1,l=0,r=0,c;const a=f=>{clearTimeout(c),c=setTimeout(()=>{i("change",f)},250)},d=f=>{const{target:v}=f;v.setPointerCapture(f.pointerId),o=!0},h=f=>{o&&(s(0,l=Math.min(Math.max(0,f.offsetX),z)),s(5,r=l/z),a(r))},m=f=>{const{target:v}=f;v.releasePointerCapture(f.pointerId),o=!1};return t.$$.update=()=>{t.$$.dirty&32&&s(1,n=Z+(ee-Z)*r)},[l,n,d,h,m,r]}class $e extends B{constructor(e){super(),F(this,e,De,Ce,N,{})}}function x(t,e,s){const n=t.slice();return n[5]=e[s],n[7]=s,n}function H(t,e){let s,n,i,o,l=I,r,c,a,d;n=new Ie({props:{delay:10*e[7],src:e[5].image_url,museum:e[5].museum}});function h(){return e[3](e[5])}return{key:t,first:null,c(){s=E("li"),J(n.$$.fragment),i=M(),this.h()},l(m){s=w(m,"LI",{class:!0});var f=y(s);W(n.$$.fragment,f),i=q(f),f.forEach(p),this.h()},h(){u(s,"class","svelte-1xhdl3v"),this.first=s},m(m,f){C(m,s,f),Q(n,s,null),k(s,i),c=!0,a||(d=j(s,"click",h),a=!0)},p(m,f){e=m;const v={};f&2&&(v.delay=10*e[7]),f&2&&(v.src=e[5].image_url),f&2&&(v.museum=e[5].museum),n.$set(v)},r(){o=s.getBoundingClientRect(),r={delay:10*e[7],duration:e[4]}},f(){ue(s),l()},a(){l(),l=he(s,o,_e,r)},i(m){c||(U(n.$$.fragment,m),c=!0)},o(m){A(n.$$.fragment,m),c=!1},d(m){m&&p(s),Y(n),a=!1,d()}}}function Se(t){let e,s,n,i,o,l,r,c=[],a=new Map,d,h,m;i=new $e({}),i.$on("change",t[2]);let f=t[1];const v=g=>g[5].id;for(let g=0;g<f.length;g+=1){let _=x(t,f,g),b=v(_);a.set(b,c[g]=H(b,_))}return{c(){e=E("div"),s=E("section"),n=E("div"),J(i.$$.fragment),o=M(),l=E("section"),r=E("ul");for(let g=0;g<c.length;g+=1)c[g].c();d=M(),h=E("section"),this.h()},l(g){e=w(g,"DIV",{class:!0});var _=y(e);s=w(_,"SECTION",{class:!0});var b=y(s);n=w(b,"DIV",{class:!0});var T=y(n);W(i.$$.fragment,T),T.forEach(p),b.forEach(p),o=q(_),l=w(_,"SECTION",{class:!0});var G=y(l);r=w(G,"UL",{class:!0});var K=y(r);for(let O=0;O<c.length;O+=1)c[O].l(K);K.forEach(p),G.forEach(p),d=q(_),h=w(_,"SECTION",{class:!0});var te=y(h);te.forEach(p),_.forEach(p),this.h()},h(){u(n,"class","inner svelte-1xhdl3v"),u(s,"class","top svelte-1xhdl3v"),u(r,"class","grid-container svelte-1xhdl3v"),u(l,"class","center svelte-1xhdl3v"),u(h,"class","bottom svelte-1xhdl3v"),u(e,"class","app-container svelte-1xhdl3v")},m(g,_){C(g,e,_),k(e,s),k(s,n),Q(i,n,null),k(e,o),k(e,l),k(l,r);for(let b=0;b<c.length;b+=1)c[b].m(r,null);k(e,d),k(e,h),m=!0},p(g,[_]){if(_&3){f=g[1],de();for(let b=0;b<c.length;b+=1)c[b].r();c=ce(c,_,v,1,g,f,a,r,fe,H,null,x);for(let b=0;b<c.length;b+=1)c[b].a();ae()}},i(g){if(!m){U(i.$$.fragment,g);for(let _=0;_<f.length;_+=1)U(c[_]);m=!0}},o(g){A(i.$$.fragment,g);for(let _=0;_<c.length;_+=1)A(c[_]);m=!1},d(g){g&&p(e),Y(i);for(let _=0;_<c.length;_+=1)c[_].d()}}}function je(t,e,s){let n;re(t,L,c=>s(1,n=c));let i;return[i,n,({detail:c})=>{s(0,i=c*499+1);const a=n[12];L.setCenter(a,i)},c=>L.setCenter(c,i),c=>30*Math.sqrt(c)]}class Te extends B{constructor(e){super(),F(this,e,je,Se,N,{})}}export{Te as default};
